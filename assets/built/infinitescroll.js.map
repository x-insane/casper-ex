{"version":3,"sources":["infinitescroll.js"],"names":["$","currentPage","pathname","window","location","$document","document","$result","buffer","ticking","isLoading","lastScrollY","scrollY","lastWindowHeight","innerHeight","lastDocumentHeight","height","onScroll","requestTick","onResize","requestAnimationFrame","infiniteScroll","maxPages","nextPage","get","content","append","find","hide","fadeIn","fail","xhr","status","removeEventListener","passive","always","replace","addEventListener"],"mappings":"AACAA,EAAE,SAAUA,GACR,IAAIC,EAAc,EACdC,EAAWC,OAAOC,SAASF,SAC3BG,EAAYL,EAAEM,UACdC,EAAUP,EAAE,cACZQ,EAAS,IAETC,GAAU,EACVC,GAAY,EAEZC,EAAcR,OAAOS,QACrBC,EAAmBV,OAAOW,YAC1BC,EAAqBV,EAAUW,SAKnC,SAASC,IACLN,EAAcR,OAAOS,QACrBM,IAGJ,SAASC,IACLN,EAAmBV,OAAOW,YAC1BC,EAAqBV,EAAUW,SAC/BE,IAGJ,SAASA,IACAT,GACDW,sBAAsBC,GAE1BZ,GAAU,EAGd,SAASY,IAEL,IAAIX,EAKJ,GAAIC,EAAcE,GAAoBE,EAAqBP,EACvDC,GAAU,OAKd,GAAIR,IAAgBqB,SAApB,CAIAZ,GAAY,EAMZ,IAAIa,EAAWrB,EAAW,WAH1BD,EAGkD,IAElDD,EAAEwB,IAAID,EAAU,SAAUE,GACtBlB,EAAQmB,OAAO1B,EAAEyB,GAASE,KAAK,SAASC,OAAOC,OAAO,QAEvDC,KAAK,SAAUC,GAEK,MAAfA,EAAIC,SACJ7B,OAAO8B,oBAAoB,SAAUhB,EAAU,CAACiB,SAAS,IACzD/B,OAAO8B,oBAAoB,SAAUd,MAG1CgB,OAAO,WACNpB,EAAqBV,EAAUW,SAE/BP,EADAC,GAAY,KAzDpBR,EAAWA,EAASkC,QAAQ,UAAW,IAAIA,QAAQ,OAAS,KA8D5DjC,OAAOkC,iBAAiB,SAAUpB,EAAU,CAACiB,SAAS,IACtD/B,OAAOkC,iBAAiB,SAAUlB,GAElCE","file":"infinitescroll.js","sourcesContent":["// Code snippet inspired by https://github.com/douglasrodrigues5/ghost-blog-infinite-scroll\r\n$(function ($) {\r\n    var currentPage = 1;\r\n    var pathname = window.location.pathname;\r\n    var $document = $(document);\r\n    var $result = $('.post-feed');\r\n    var buffer = 100;\r\n\r\n    var ticking = false;\r\n    var isLoading = false;\r\n\r\n    var lastScrollY = window.scrollY;\r\n    var lastWindowHeight = window.innerHeight;\r\n    var lastDocumentHeight = $document.height();\r\n\r\n    // remove hash params from pathname\r\n    pathname = pathname.replace(/#(.*)$/g, '').replace('/\\//g', '/');\r\n\r\n    function onScroll() {\r\n        lastScrollY = window.scrollY;\r\n        requestTick();\r\n    }\r\n\r\n    function onResize() {\r\n        lastWindowHeight = window.innerHeight;\r\n        lastDocumentHeight = $document.height();\r\n        requestTick();\r\n    }\r\n\r\n    function requestTick() {\r\n        if (!ticking) {\r\n            requestAnimationFrame(infiniteScroll)\r\n        }\r\n        ticking = true;\r\n    }\r\n\r\n    function infiniteScroll () {\r\n        // return if already loading\r\n        if (isLoading) {\r\n            return;\r\n        }\r\n\r\n        // return if not scroll to the bottom\r\n        if (lastScrollY + lastWindowHeight <= lastDocumentHeight - buffer) {\r\n            ticking = false;\r\n            return;\r\n        }\r\n\r\n        // return if currentPage is the last page already\r\n        if (currentPage === maxPages) {\r\n            return;\r\n        }\r\n\r\n        isLoading = true;\r\n\r\n        // next page\r\n        currentPage++;\r\n\r\n        // Load more\r\n        var nextPage = pathname + 'page/' + currentPage + '/';\r\n\r\n        $.get(nextPage, function (content) {\r\n            $result.append($(content).find('.post').hide().fadeIn(100));\r\n\r\n        }).fail(function (xhr) {\r\n            // 404 indicates we've run out of pages\r\n            if (xhr.status === 404) {\r\n                window.removeEventListener('scroll', onScroll, {passive: true});\r\n                window.removeEventListener('resize', onResize);\r\n            }\r\n\r\n        }).always(function () {\r\n            lastDocumentHeight = $document.height();\r\n            isLoading = false;\r\n            ticking = false;\r\n        });\r\n    }\r\n\r\n    window.addEventListener('scroll', onScroll, {passive: true});\r\n    window.addEventListener('resize', onResize);\r\n\r\n    infiniteScroll();\r\n});\r\n"],"sourceRoot":"/source/"}